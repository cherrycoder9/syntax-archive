# 변수의 생명 주기와 스코프

## 자동 변수와 정적 변수

C 언어에서 변수의 저장 기간(storage duration)은 변수가 메모리에 존재하는 시간을 결정함. 자동 변수와 정적 변수는 이러한 저장 기간에 따라 구분되는 두 가지 주요 변수 유형임.

### 자동 변수 (Automatic Variables)

1. 정의
   - 블록 내에서 선언되며, 명시적인 저장 클래스 지정자 없이 선언된 변수
   - 기본적으로 모든 지역 변수는 자동 변수임

2. 특징
   - 블록 진입 시 생성되고, 블록 종료 시 소멸됨
   - 초기화되지 않으면 쓰레기 값을 가짐
   - 스택 메모리에 할당됨

3. 예제

   ```c
   void func() {
       int x = 10;  // 자동 변수
       auto int y = 20;  // 'auto' 키워드는 불필요 (C11 이전)
       printf("%d %d\n", x, y);
   }  // x와 y는 여기서 소멸됨
   ```

4. 장점
   - 메모리 효율성: 필요할 때만 메모리 사용
   - 재진입성: 함수의 여러 호출이 서로 독립적

5. 단점
   - 함수 호출 간 값 유지 불가

### 정적 변수 (Static Variables)

1. 정의
   - static 키워드로 선언된 변수
   - 지역 정적 변수와 전역 정적 변수로 구분

2. 특징
   - 프로그램 시작 시 생성되고, 프로그램 종료 시 소멸됨
   - 초기화되지 않으면 0으로 자동 초기화됨
   - 데이터 세그먼트에 할당됨

3. 지역 정적 변수

   ```c
   void counter() {
       static int count = 0;  // 지역 정적 변수
       count++;
       printf("호출 횟수: %d\n", count);
   }

   int main() {
       counter();  // 출력: 호출 횟수: 1
       counter();  // 출력: 호출 횟수: 2
       return 0;
   }
   ```

4. 전역 정적 변수

   ```c
   static int global_static = 100;  // 파일 범위 정적 변수

   void func() {
       printf("%d\n", global_static);
   }
   ```

5. 장점
   - 값 유지: 함수 호출 간 상태 유지 가능
   - 캡슐화: 파일 범위 정적 변수로 전역 네임스페이스 오염 방지

6. 단점
   - 메모리 사용: 프로그램 전체 수행 동안 메모리 점유
   - 초기화 복잡성: 복잡한 초기화 로직 구현 어려움

### 자동 변수와 정적 변수의 비교

1. 초기화

   ```c
   void func() {
       int a;  // 초기화되지 않음 (쓰레기 값)
       static int b;  // 0으로 초기화됨
       printf("%d %d\n", a, b);
   }
   ```

2. 값 유지

   ```c
   void auto_func() {
       int count = 0;
       count++;
       printf("Auto: %d\n", count);
   }

   void static_func() {
       static int count = 0;
       count++;
       printf("Static: %d\n", count);
   }

   int main() {
       auto_func();   // 출력: Auto: 1
       auto_func();   // 출력: Auto: 1
       static_func(); // 출력: Static: 1
       static_func(); // 출력: Static: 2
       return 0;
   }
   ```

3. 가시성
   - 자동 변수: 선언된 블록 내에서만 접근 가능
   - 정적 변수: 선언 위치에 따라 파일 전체 또는 함수 내에서 접근 가능

### 사용 지침

1. 자동 변수 선호: 대부분의 경우 자동 변수 사용
2. 상태 유지 필요 시 정적 변수 고려
3. 전역 변수 대신 파일 범위 정적 변수 사용 고려
4. 스레드 안전성 주의: 정적 변수 사용 시 동시성 문제 고려

자동 변수와 정적 변수의 특성을 이해하고 적절히 사용하면 효율적이고 안전한 프로그램 작성이 가능함. 각 변수 유형의 장단점을 고려하여 상황에 맞는 선택을 해야 함.
