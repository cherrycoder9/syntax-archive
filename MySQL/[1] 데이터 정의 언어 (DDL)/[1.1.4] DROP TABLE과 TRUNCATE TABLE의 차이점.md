# 테이블 생성과 구조 변경

## DROP TABLE과 TRUNCATE TABLE의 차이점

DROP TABLE과 TRUNCATE TABLE은 둘 다 테이블의 데이터를 제거하는 데 사용되지만, 동작 방식과 결과에 중요한 차이가 있음. 이 두 명령어의 특징과 차이점을 자세히 살펴보자.

### DROP TABLE

```sql
DROP TABLE [IF EXISTS] 테이블명;
```

1. 동작 방식:
   - 테이블 구조와 모든 데이터를 완전히 제거함
   - 테이블 정의, 인덱스, 제약 조건 등 모든 메타데이터도 함께 삭제됨

2. 특징:
   - 실행 후 테이블이 데이터베이스에서 완전히 사라짐
   - 테이블과 관련된 모든 객체(뷰, 트리거 등)도 영향을 받을 수 있음
   - AUTO_INCREMENT 값도 리셋됨

3. 트랜잭션:
   - InnoDB 엔진에서는 트랜잭션 내에서 실행 가능
   - ROLLBACK으로 취소 가능 (버전과 설정에 따라 다를 수 있음)

4. 권한:
   - DROP 권한이 필요함

5. 사용 사례:
   - 테이블을 완전히 제거하고 싶을 때
   - 테이블 구조를 처음부터 다시 정의해야 할 때

### TRUNCATE TABLE

```sql
TRUNCATE [TABLE] 테이블명;
```

1. 동작 방식:
   - 테이블의 모든 데이터를 제거하지만 구조는 유지함
   - 내부적으로 테이블을 삭제하고 다시 생성하는 방식으로 동작함

2. 특징:
   - 테이블 구조, 컬럼, 제약 조건 등은 그대로 유지됨
   - 인덱스는 초기화되지만 삭제되지는 않음
   - AUTO_INCREMENT 값이 초기화됨 (보통 1로 리셋)
   - 대용량 데이터 삭제 시 DELETE보다 일반적으로 빠름

3. 트랜잭션:
   - InnoDB에서도 암시적 커밋을 유발함 (트랜잭션으로 롤백 불가)
   - MySQL 8.0부터는 TRUNCATE 작업을 원자적으로 수행 가능

4. 권한:
   - DROP 권한이 필요함 (내부적으로 DROP과 CREATE를 수행하기 때문)

5. 사용 사례:
   - 테이블 구조는 유지하면서 모든 데이터만 빠르게 제거하고 싶을 때
   - 대용량 테이블의 데이터를 효율적으로 비우고 싶을 때

### 주요 차이점 요약

1. 구조 유지:
   - DROP: 테이블 구조와 데이터 모두 제거
   - TRUNCATE: 데이터만 제거하고 구조는 유지

2. 속도:
   - DROP: 메타데이터 삭제로 인해 약간 더 느릴 수 있음
   - TRUNCATE: 대용량 데이터 처리 시 일반적으로 더 빠름

3. 로깅:
   - DROP: 개별 행 삭제를 로깅하지 않아 로그 크기가 작음
   - TRUNCATE: 데이터 페이지 할당 해제만 로깅하여 로그 크기가 매우 작음

4. 복구 가능성:
   - DROP: FLASHBACK같은 특별한 기능 없이는 복구 어려움
   - TRUNCATE: 일부 DBMS에서 FLASHBACK으로 복구 가능 (MySQL은 미지원)

5. 트리거:
   - DROP: 트리거가 발동하지 않음
   - TRUNCATE: DELETE 트리거가 발동하지 않음 (TRUNCATE 자체 트리거는 가능)

### 사용 시 주의사항

1. 데이터 중요성:
   두 명령 모두 데이터를 영구적으로 제거하므로 실행 전 반드시 백업 필요

2. 외래 키:
   - TRUNCATE는 참조 무결성을 위반할 수 있어 외래 키가 있는 경우 주의 필요
   - 필요시 참조 무결성 제약 조건을 일시적으로 비활성화해야 할 수도 있음

3. 권한 관리:
   두 명령 모두 강력한 작업이므로 적절한 권한 관리가 중요함

4. 성능 고려:
   대용량 데이터 처리 시 TRUNCATE가 일반적으로 더 효율적이지만, 항상 그런 것은 아님

5. 복구 계획:
   실수로 실행했을 때를 대비한 복구 계획을 미리 수립해 두는 것이 좋음

DROP TABLE과 TRUNCATE TABLE은 각각 다른 상황에서 유용하게 사용될 수 있음. 테이블 구조까지 제거할 필요가 있다면 DROP TABLE을, 구조는 유지하면서 데이터만 빠르게 제거하고 싶다면 TRUNCATE TABLE을 선택하는 것이 적절함. 항상 실행 전 의도를 명확히 하고 영향을 충분히 검토한 후 사용해야 함.
